<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="/css/style.css">
        <link rel="stylesheet" href="/css/icomoon (1)/style.css">
        <link rel="icon" type="image/png" href="/threads.png">
        <title>Profile</title>
    </head>

    <body class="bg-[#0a0a0a] font-sans">
        <nav class="bg-white fixed top-0 w-[100%] shadow-md px-3 py-2 sm:py-4 sm:px-8 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <span class="text-black text-2xl font-bold tracking-tight">Threads</span>
            </div>
            <div class="flex sm:gap-4">
                <a href="#" class="text-gray-700 hover:text-black hover:bg-gray-300 rounded p-1 font-medium text-sm">Explore</a>
                <a href="/signup"
                    class="text-gray-700 hover:text-black hover:bg-gray-300 p-1 rounded font-bold text-sm">Signup</a>
                <a href="/login"
                    class="text-gray-700 hover:text-black  bg-gray-300 rounded shadow-md p-1 font-bold text-sm">Login</a>
            </div>
        </nav>
        <div class="mb-[10px] sm:mb-[100px]"></div>
                <main class="mx-auto my-10">
                    <!-- Profile Card Modern -->
                    <div class="max-w-2xl mx-auto bg-black rounded-3xl shadow-lg p-8 flex flex-col items-center gap-4 mb-5">
                        <% if (user.avatar) { %>
                            <img src="<%= user.avatar%>" class="w-28 h-28 rounded-full object-cover border-4 border-[#555] shadow" alt="<%= user.avatar || 'user avatar' %>">
                        <% } else { %>
                            <span class="icon-user text-gray-500 text-[100px] rounded-full bg-[#555] border-[#555]"></span>
                        <% }%>
                        <h3 class="text-2xl text-gray-200 font-bold mt-2"><%= user.username || 'No username available' %></h3>
                        <p class="text-gray-400 text-center max-w-md"><%= user.bio ? user.bio : 'No bio available' %></p>
                        <span class="text-gray-500 text-xs"><%= user.email ? user.email : 'No email available' %></span>
                        <div class="flex gap-8 mt-2 text-center">
                            <div>
                                <span class="block text-lg font-bold text-gray-500"><%= posts.length || '0' %></span>
                                <span class="text-xs text-gray-400">المنشورات</span>
                            </div>
                            <div>
                                <span class="block text-lg font-bold text-gray-500"><%= user.followersCount || '0' %></span>
                                <span class="text-xs text-gray-400">المتابعين</span>
                            </div>
                            <div>
                                <span class="block text-lg font-bold text-gray-500"><%= user.followingCount || '0' %></span>
                                <span class="text-xs text-gray-400">يتابع</span>
                            </div>
                        </div>
                        <a href="/profile/edit" class="mt-4 px-6 py-2 rounded-full border border-gray-600 text-gray-300 hover:bg-gray-700/30 transition font-bold text-sm">تعديل الملف الشخصي</a>
                    </div>

            <div class="flex md:flex-row-reverse">
                <!-- buttons -->
                <div>
                 <div class="flex flex-row justify-center gap-3 p-2 md:flex-col z-10
                    md:bg-transparent
                    bg-black
                    
                    fixed 
                    bottom-0
                    md:bottm-[0%]
                    md:top-[50%]
                    md:translate-y-[-50%]
                    md:right-0
                    md:w-fit
                    w-[100vw]
                    ">
                        <a href="/" class="hover:bg-gray-800 p-2 rounded transition-all"><span
                                class="hover:opacity-100 icon-home text-white text-3xl opacity-30"></span></a>
                        <a href="/search" class="hover:bg-gray-800 p-2 rounded transition-all"><span
                                class="hover:opacity-100 icon-search2 text-white text-3xl opacity-30"></span></a>
                        <a href="/likes" class="hover:bg-gray-800 p-2 rounded transition-all"><span
                                class="hover:opacity-100 icon-heart-outline text-white text-3xl opacity-30"></span></a>
                        <a href="/profile" class="hover:bg-gray-800 p-2 rounded transition-all"><span
                                class="hover:opacity-100 icon-user text-white text-3xl "></span></a>
                    </div>
                </div>
                <!-- Contents -->
                <div dir="rtl" class="sm:rounded-3xl h-[75vh] sm:bg-black mx-auto overflow-y-auto  custom-scroll p-4 sm:w-[80%] w-[100%]">
                    <div class="max-h-[90vh]  text-white">
    
                        <!--Tabs navigation-->
                        <h1 class="text-center text-4xl mb-5">منشوراتي</h1>
                        <ul class=" overflow-auto mb-5 flex list-none flex-row justify-center border-b-0 ps-0" role="tablist" data-twe-nav-ref>
                            <li role="presentation">
                                    <% if (!posts.length) { %>
                                        <p class="text-center text-gray-500 text-lg mt-[100px]">لا يوجد منشورات بعد</p>
                                    <% } else {%>
                                        <div id="userPostsList" class="flex flex-col gap-6">
                                            <% posts.forEach(post=> { %>
                                                <div class="bg-black rounded-xl p-5 shadow flex flex-col gap-2">
                                                    <div class="flex items-center gap-2 mb-2">
                                                        <img src="<%= user.avatar %>" class="w-8 h-8 rounded-full object-cover">
                                                        <span class="font-semibold text-sm">
                                                            <%= user.username %>
                                                        </span>
                                                        <span class="text-xs text-gray-500 ms-auto">
                                                            <%= moment(post.createdAt).fromNow() %>
                                                        </span>
                                                    </div>
                                                    <div class="text-gray-200 text-base leading-relaxed">
                                                        <%= post.content %>
                                                    </div>
                                                    <div class="flex gap-4 mt-2 text-gray-400 text-sm">
                                                        <span class="flex items-center gap-1"><i class="icon-heart-outline"></i>
                                                            <%= post.likes.length %>
                                                        </span>
                                                        <span class="flex items-center gap-1"><i class="icon-bubble"></i>
                                                            <%= post.comments.length %>
                                                        </span>
                                                    </div>
                                                </div>
                                                <hr class="opacity-5">
                                                <% }) %>
                                        </div>
                                    <% } %>
                                    
                            </li>
                        </ul>
                </div>
            </div>
        </div>
    </div>
    </div>
    
        </main>

        <!-- <footer class="bg-black text-white text-center py-6 mt-16">
    <p>&copy; 2025 Threads Application</p>
  </footer> -->
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
        <script>
            // axios.get('/profile', {
            //     withCredentials: true
            // })
            // .catch(err => {
            //     console.log(err.response?.data || err.message);
            //     console.log("حدث خطأ أثناء تحميل الملف الشخصي. الرجاء تسجيل الدخول من جديد.");
            //     window.location.href = "/login";
            // });
        </script>

        <script type="text/javascript" src="/js/tw-elements.umd.min.js"></script>
    </body>

</html>